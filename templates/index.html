<!DOCTYPE html>
<html>

<head>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
</head>

<body bgcolor="#e1f5fe">
    <!-- navbar -->
		<div class="navbar-fixed">
    <nav>
      <div class="nav-wrapper">
        <nav class="nav" style="background-color:#00f260">
          <a href="#" class="brand-logo center">churnator<span style="color:black!important">.ai</span></a>
          <ul id="nav-mobile" class="left hide-on-med-and-down">
          </ul>
      </div>
    </nav>
	</div>

  <div class="divider"></div>
  <div class="section">

    <div class="row">
      <form class="col s12">
        <div class="row">
          <div class="input-field col s4 offset-s2">
            <input id="name" type="text" class="validate">
            <label for="name">Name</label>
          </div>
          <div class="input-field col s4">
            <input id="id" type="text" class="validate">
            <label for="id">Customer Id</label>
          </div>
        </div>
        <div class="row">
          <div class="input-field col s8 offset-s2">
            <input id="score" type="number" class="validate">
            <label for="score">Credit Score</label>
          </div>
        </div>
        <div class="row">
          <div class="input-field col s8 offset-s2">
			<input id="location" type="email" class="validate" disabled>
			<select class="browser-default" id="locationSelect">
					<option value="" disabled selected>Choose a country</option>
					<option value="1">France</option>
					<option value="2">Germany</option>
					<option value="3">Spain</option>
				  </select>
            <label for="Geography">Geography</label>
          </div>
        </div>
        <div class="row">
          <div class="input-field col s8 offset-s2">
			<input id="gender" type="email" class="validate"disabled>
			<select class="browser-default" id="genderSelect">
					<option value="" disabled selected>Choose a gender</option>
					<option value="1">Male</option>
					<option value="2">Female</option>
				  </select>
            <label for="gender">Gender</label>
          </div>
        </div>
        <div class="row">
          <div class="input-field col s8 offset-s2">
            <input id="age" type="number" class="validate">
            <label for="age">Age</label>
          </div>
        </div>
        <div class="row">
          <div class="input-field col s8 offset-s2">
            <input id="tenure" type="number" class="validate">
            <label for="tenure">Tenure</label>
          </div>
        </div>
        <div class="row">
          <div class="input-field col s8 offset-s2">
            <input id="balance" type="number" class="validate">
            <label for="balance">Balance</label>
          </div>
        </div>
        <div class="row">
          <div class="input-field col s8 offset-s2">
            <input id="products" type="number" class="validate">
            <label for="products">Number of products</label>
          </div>
        </div>
        <div class="row">
          <div class="input-field col s8 offset-s2">
			<input id="creditCard" type="email" class="validate" disabled>
			<select class="browser-default" id="creditCardSelect">
					<option value="" disabled selected>Choose an option</option>
					<option value="1">Yes</option>
					<option value="2">No</option>
				  </select>
            <label for="creditCard">Has Credit Card</label>
          </div>
        </div>
        <div class="row">
          <div class="input-field col s8 offset-s2">
			<input id="member" type="email" class="validate" disabled>
			<select class="browser-default" id="activeMemberSelect">
					<option value="" disabled selected>Choose an option</option>
					<option value="1">Yes</option>
					<option value="2">No</option>
				  </select>
            <label for="member">Is Active Member</label>
          </div>
        </div>
        <div class="row">
          <div class="input-field col s8 offset-s2">
            <input id="salary" type="number" class="validate">
            <label for="salary">Estimated Salary (USD)</label>
          </div>
        </div>
       <div class="center-align">
          <a href="#" class="btn waves-effect waves-light green accent-3" type="submit" name="action" onclick="submit()">Submit
              <i class="material-icons right">send</i>
          </a>
       </div>
    </div>
    </form>
  </div>

  </div>

  <div class="divider"></div>
  <div class="section">
  </div>

	<!-- Modal Structure -->
  <div id="modal1" class="modal">
    <div class="modal-content">
      <h4>Results</h4>
      <p id="one"></p>
			<br>
			<p>Required actions:</p>

			<div class="row">
	 <div class="col s6 m6">
		 <div class="card green">
			 <div class="card-content white-text">
				 <p class="lol">Contact product teams</p>
			 </div>
			 <div class="card-action">
          <a class="lolz"></a>
        </div>
		 </div>
	 </div>
	 <div class="col s6 m6">
		 <div class="card green">
			 <div class="card-content white-text">
				 <p class="lol">Targeted advertising on social media</p>
			 </div>
			 <div class="card-action">
          <a class="lolz"></a>
        </div>
		 </div>
	 </div>
 </div>
 <div class="row">
<div class="col s6 m6">
<div class="card green">
	<div class="card-content white-text">
		<p class="lol">Send customer service email</p>
	</div>
	<div class="card-action">
		 <a class="lolz"></a>
	 </div>
</div>
</div>
<div class="col s6 m6">
<div class="card green">
	<div class="card-content white-text">
		<p class="lol">Offer promotions</p>
	</div>
	<div class="card-action">
		 <a class="lolz"></a>
	 </div>
</div>
</div>
</div>

    </div>
    <div class="modal-footer">
      <a href="#!" class="modal-close waves-effect waves-green btn-flat">Close</a>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.0/axios.min.js"></script>

	<script>
	var instances
	document.addEventListener('DOMContentLoaded', function() {
    var elems = document.querySelectorAll('.modal');
    instances = M.Modal.init(elems, {});
  });
	</script>

	<script>

	function submit() {

		alert('Please wait...')

		var creditScore = parseInt(document.getElementById('score').value);
		var age = parseInt(document.getElementById('age').value);
		var location = parseInt(document.getElementById('locationSelect').value);
		var tenure = parseInt(document.getElementById('tenure').value);
		var balance = parseInt(document.getElementById('balance').value);
		var products = parseInt(document.getElementById('products').value);
		var salary = parseInt(document.getElementById('salary').value);
		var hasCreditCard = parseInt(document.getElementById('creditCardSelect').value);
		if (hasCreditCard === 2) {
			hasCreditCard = 0;
		}
		var isActiveMember = parseInt(document.getElementById('activeMemberSelect').value);
		if (isActiveMember === 2) {
			isActiveMember = 0;
		}

		var location1, location2;
		if (location === 1) {
			location1 = 0;
			location2 = 0;
		} else if (location === 2) {
			location1 = 1;
			location2 = 0;
		} else if (location === 3) {
			location1 = 0;
			location2 = 1;
		}
		var gender = parseInt(document.getElementById('genderSelect').value);
		if (gender === 2) {
			gender = 0;
		}

		//console.log(age, location, tenure, balance, products, salary, hasCreditCard, isActiveMember, location1, location2, gender);
		predict(location1, location2, creditScore, gender, age, tenure, balance, products, hasCreditCard, isActiveMember, salary);
	}

		function predict(location1, location2, creditScore, gender, age, tenure, balance, products, hasCreditCard, isActiveMember, salary) {
			axios.get('predict', {params: {location1: location1, location2: location2, creditScore:creditScore, gender:gender, age:age, tenure:tenure, balance: balance, products:products, hasCreditCard:hasCreditCard, isActiveMember:isActiveMember, salary:salary}})
			.then(function(res) {
				console.log(res.data)
				document.getElementById('one').innerHTML = "The customer's likelyhood of leaving is " + ((res.data)*100).toFixed(2) + "%.";

				if(res.data < 0.5) {
					var arr = document.getElementsByClassName('lol');
					var arr2 = document.getElementsByClassName('lolz')
					for (var i=0;i<arr.length;i++) {
						arr[i].style.textDecoration = 'line-through';
					}
					for (var i=0;i<arr2.length;i++) {
						arr2[i].innerHTML = 'Not required';
					}
				} else {
					for (var i=0;i<arr.length;i++) {
						arr[i].style.textDecoration = '';
					}
					for (var i=0;i<arr2.length;i++) {
						arr2[i].innerHTML = 'Required';
					}
				}

				instances[0].open();
			});
		}

	</script>

</body>
<style>
  body {
    font-family: 'Open Sans', sans-serif;
  }
  a.button {
    -webkit-appearance: button;
    -moz-appearance: button;
    appearance: button;

    text-decoration: none;
    color: initial;
}
</style>

</html>
